<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2405px" height="2124px" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0&quot; version=&quot;9.1.3&quot; editor=&quot;www.draw.io&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;b2da593b-377b-f9a5-e02f-5d95bb8bd4b4&quot; name=&quot;Page-1&quot;&gt;7Vjdb+I4EP9b7iFq+wAKBEL72NLt9U7avZVYdR+RSSbEi4mzjgPlHu5vvxk7nwRaDnEnnVSa5uNne2YyX56J403Xr78qlsafZQjCGbrhq+M9OsPhYOCN8ELIziL+6NYCS8XDYlINzPifUIBugeY8hKw1UUspNE/bYCCTBALdwphSctueFknR5pqyJXSAWcBEF/3OQx1b9HY4qfFn4Mu45Dzw7+zIggWrpZJ5UvBzhl5kfnZ4zUpaxYtmMQvltgF5nxxvqqTU9m79OgVBui3VZtc9HRmt5FaQ6FMWFGbZMJFDKbEvcOlDyDekTMGXiRnwf+Yk1IOASNdPeLcsrmbVogS+5gvBsxhCJPKSiwQUW3DBNUezFnNRqkVnvToBKYEvs6+9se+fS28GG1Bco4veO6SmPeqfIeT5+jBx93r6MpvhdRZIBZbAqO/enML2BVTGZYJqcGVEjH03lrDCC1lOcamMtxuKw/6AjJCQFsd9t+8Z/wayWKFTAeXsVEkt9S4lIJVC5Bq59E+R6FsMVo41KIwLI0iUJwERcIbTSgJdzmNpKnbf5CNELBc6syvsnO7od67jWcyEQD9vkSYNbGMexHgVZAsKyn05FhDzBvMsgIQ8aPqGItgxZdCY1hihhjEkdt4GU01o5MfTPE8wFnjINIRzE0k7IRkNBwoIJPmVXBdsfp/98YWk0oonS5uPNOOJfajUNZ8bcebz0sYyBaV3J9qGk54CI92CCIawRt1pVUgj+MooRhovPEYQ3dcEdBs9M8Y/qH9Q/6D+Qb2bpoqMa/a1KtU2cleemZxl0rTEjL/F/ZdweOWZtlmzyI6mTsCleWZhk9SlxrKGM1NrQmJvDK8M1IYHcFJG7Wz0eGXrFG+SRZae9Oxi5YHnHv7fhxueSbWjDRpLEVMJfH1n8zmvXHlpbnQzGemt3QAr8eyZ6q2ywnhrR7isQkwFY9jZEfuG5EmmiqFtz5lM6WgIvKwnUXHjNscKFZVVz3GV7fuzqar1rqzkTS0OVO26OIzlhoZZygIa3WLvglis1wKfBngbcSGmUmAFRmu9aEx/iONuK1fQGPHNr+KHnqzh9WgJPqgKe2yYQK5BG38pF5S9QNErDUbF87buPMZ+gcWNrmM0KUBWdDvLinZd8eNNUfQfbgC8TgMQwsYZuWmA5vzLGWIj5/ZJx5ACKjIJdr0ghmDVz6hs6/UwXH9QB2ZMV6SJBF51IGQeDrxm7sDZmc0FNZpSQzR8ooTwVC0j4dvrZL7HIeixPOS6zeD/Z3q3bfrbruV995DlL2D4yb/V+T1WnvLP88i7eeZk6HiKLYFn1Cdk5FdVI3hSZt5PdacLj92cb1q4c1/sXQ5lz/qWUt4vCS4ZR1E0DIJDcRT6C398oTga+XspdNwNpOrbUjOQxhcIpLtLBZLv2uMH27AsUDzVXZNtGH0deCYXRIuarVPBz5wruL4ix7y6OeizdtkaRQm4zLN53dZaGlfO5KGWqO5XayHR4ZtTpEyz9mj18BuF1FaqFRVwvzQmTR7xuDqx2rESs0pC4o4EDk3FpjuTAvpCLq9rdg8QSVsflZ936g3FGdKZ9ektDiuMNNw3nyGuC87mkwP1+330ywyuO8q8OUzpsHT3kQZ1rnCVp/wXAXwXTWhpN4A937vzwssEMEZiK4C9AwFcYc0AHpyxFeJj/YHVjDW+Ynuf/gY=&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g transform="translate(0.5,0.5)"><rect x="80" y="240" width="2240" height="1880" fill="#f5f5f5" stroke="#666666" stroke-width="4" pointer-events="none"/><g transform="translate(87.5,261.5)scale(4)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="556" height="459" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 556px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div align="left"><b>Published Vulnerabilities</b><br /><br /><b>NSP-566</b><br /><br />Severity: <b>Medium</b> (CVSS Score: 4.0)<br /><br />Versions of `hoek` prior to 4.2.1 and 5.0.3 are vulnerable to prototype pollution.<br /><br />The `merge` function, and the `applyToDefaults` and `applyToDefaultsWithShallow` functions which leverage `merge` behind the scenes, are vulnerable to a prototype pollution attack when provided an _unvalidated_ payload created from a JSON string containing the `__proto__` property.<br /><br />This can be demonstrated like so:<br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br /></div><div align="left"><br />This type of attack can be used to overwrite existing properties causing a potential denial of service.<br /><br /><b>    NSP - Advisory 566: Prototype pollution attack</b><br /><br />Vulnerable Software &amp; Versions:<br /><br /><b>    hoek:&lt;= 4.2.0 || &gt;= 5.0.0 &lt; 5.0.3</b></div></div></div></foreignObject><text x="278" y="236" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="0" y="0" width="2400" height="160" fill="#f5f5f5" stroke="#666666" stroke-width="4" pointer-events="none"/><g transform="translate(83.5,55.5)scale(4)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="558" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 559px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">dev@pc:~$ ./dependency-check.sh --project "nextcloud13" --scan "path/to/nextcloud/" --out "nc-audit13"</div></div></foreignObject><text x="279" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">dev@pc:~$ ./dependency-check.sh --project "nextcloud13" --scan "path/to/nextcloud/" --out "nc-audit13"</text></switch></g><rect x="1440" y="280" width="840" height="200" fill="#fff2cc" stroke="#d6b656" stroke-width="4" pointer-events="none"/><g transform="translate(1465.5,325.5)scale(4)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="197" height="27" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 198px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div align="left"><b>Dependency          </b><b>Highest Severity</b><br />hoek:    2.16.3         Medium   <br /></div></div></div></foreignObject><text x="99" y="20" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="500" y="1080" width="1400" height="560" fill="#f9f7ed" stroke="#36393d" stroke-width="4" pointer-events="none"/><g transform="translate(561.5,1103.5)scale(4)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="319" height="128" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 320px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div align="left">```javascript<br />var Hoek = require('hoek');<br />var malicious_payload = '{"__proto__":{"oops":"It works !"}}';<br /><br />var a = {};<br />console.log("Before : " + a.oops);<br />Hoek.merge({}, JSON.parse(malicious_payload));<br />console.log("After : " + a.oops);<br />```</div></div></div></foreignObject><text x="160" y="70" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>